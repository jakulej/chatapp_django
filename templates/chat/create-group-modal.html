<div id="modal-create-group" class="fixed inset-0 hidden bg-black bg-opacity-50 flex items-center justify-center z-50">
    <h3>Create Group</h3>
    <div id="modal-create-group-user-friends">
    {% for friend in request.user.friends.all %}
        {% include "chat/create-group-modal-record.html" with username=friend.username %}
    {% endfor %}
    </div>
    <button id="modal-create-group-button-submit" data-username="{{ username }}">Create Group</button>
</div>
<script>
        const requestUrl = 'createRoom/'
        const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;
        document.getElementById('modal-create-group-button-submit').addEventListener('click' , async function(e) {
            const checked = document.querySelectorAll('.modal-create-group-friend-record-checbox:checked');
            const values = Array.from(checked).map( checkbox => checkbox.dataset.username);
            

            try {
                const response = await fetch(requestUrl,{
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': csrftoken
                    },
                    body: JSON.stringify({ users: values })
                });
                if (!response.ok) {
                    throw new Error(`Response status: ${response.status}`);
                }else {
                    //Message: Room created sucesfully
                }
            } catch (error) {
                console.error(error.message);
            }

        });

</script>
